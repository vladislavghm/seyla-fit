#!/bin/bash
# ะกะบัะธะฟั ะดะปั ะพัะธััะบะธ ะผะตััะฐ ะฝะฐ ะดะธัะบะต

set -e

echo "๐งน ะัะธััะบะฐ ะผะตััะฐ ะฝะฐ ะดะธัะบะต..."

# ะัะพะฒะตััะตะผ ัะตะบััะตะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต
echo "๐ ะขะตะบััะตะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะดะธัะบะฐ:"
df -h

echo ""
echo "๐งน ะัะธัะฐะตะผ ะบะตัะธ ะธ ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั..."

# ะัะธัะฐะตะผ ะบะตั npm/pnpm
if [ -d "$HOME/.pnpm-store" ]; then
    echo "   ะัะธัะฐะตะผ pnpm ะบะตั..."
    pnpm store prune 2>/dev/null || true
fi

# ะัะธัะฐะตะผ ะบะตั npm
if [ -d "$HOME/.npm" ]; then
    echo "   ะัะธัะฐะตะผ npm ะบะตั..."
    npm cache clean --force 2>/dev/null || true
fi

# ะัะธัะฐะตะผ ััะฐััะต ะปะพะณะธ PM2
if [ -d "$HOME/.pm2/logs" ]; then
    echo "   ะัะธัะฐะตะผ ััะฐััะต ะปะพะณะธ PM2..."
    pm2 flush 2>/dev/null || true
fi

# ะัะธัะฐะตะผ ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั
echo "   ะัะธัะฐะตะผ ะฒัะตะผะตะฝะฝัะต ัะฐะนะปั..."
sudo rm -rf /tmp/* 2>/dev/null || true
sudo rm -rf /var/tmp/* 2>/dev/null || true

# ะัะธัะฐะตะผ ะบะตั Next.js (ะตัะปะธ ะตััั ััะฐััะต ัะฑะพัะบะธ)
if [ -d "$HOME/seyla-fit/.next/cache" ]; then
    echo "   ะัะธัะฐะตะผ ะบะตั Next.js..."
    rm -rf "$HOME/seyla-fit/.next/cache" 2>/dev/null || true
fi

# ะัะธัะฐะตะผ ััะฐััะต ัะฑะพัะบะธ (ะพััะฐะฒะปัะตะผ ัะพะปัะบะพ ะฟะพัะปะตะดะฝัั)
if [ -d "$HOME/seyla-fit/.next" ]; then
    echo "   ะัะธัะฐะตะผ ััะฐััะต ะฐััะตัะฐะบัั ัะฑะพัะบะธ..."
    find "$HOME/seyla-fit/.next" -name "*.map" -type f -delete 2>/dev/null || true
fi

# ะัะธัะฐะตะผ ัะธััะตะผะฝัะต ะปะพะณะธ (ััะฐััะต)
echo "   ะัะธัะฐะตะผ ััะฐััะต ัะธััะตะผะฝัะต ะปะพะณะธ..."
sudo journalctl --vacuum-time=3d 2>/dev/null || true

echo ""
echo "โ ะัะธััะบะฐ ะทะฐะฒะตััะตะฝะฐ!"
echo ""
echo "๐ ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะดะธัะบะฐ ะฟะพัะปะต ะพัะธััะบะธ:"
df -h

